!function(e,t){if(!e.$wCalendar)throw new Error("$wCalendar is not defined");!function(e,t){var n=t("style#wCalendarStyle");if(n.nodeList.length<=0){var n=t(document.createElement("style"));n.html("CSSPLACEHOLDER"),t("body").append(n)}var i=function(e,t,n){return"object"==typeof e&&void 0!==e[t]?e[t]:n},a=function(e){throw new Error(e)},r=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},d=function(e){var n=t(document.createElement("div"));n.attr("unselectable","on").attr("onselectstart","return false;").attr("class","wCalendar-box-c").html("HTMLPLACEHOLDER"),t("body").append(n),this.node=n,this.calendar=e,this.bindInitEvents().setTitle().update()};d.prototype.bindInitEvents=function(){var e=this,t=e.node,n=e.calendar;return t.find(".wCalendar-box-layer, .cal-button.cancel").click(function(){e.hide()}),t.find(".cal-button.confirm").click(function(){e.confirmUserSelectedTime()}),t.find(".start-box .turn-left").click(function(){var t=new Date(n.startTimeTurned.getTime());n.startTimeTurned=new Date(t.getFullYear(),t.getMonth()-1),e.update()}),t.find(".start-box .turn-rigt").click(function(){var t=new Date(n.startTimeTurned.getTime());n.startTimeTurned=new Date(t.getFullYear(),t.getMonth()+1),e.update()}),t.find(".end-box .turn-left").click(function(){var t=new Date(n.endTimeTurned.getTime());n.endTimeTurned=new Date(t.getFullYear(),t.getMonth()-1),e.update()}),t.find(".end-box .turn-rigt").click(function(){var t=new Date(n.endTimeTurned.getTime());n.endTimeTurned=new Date(t.getFullYear(),t.getMonth()+1),e.update()}),this},d.prototype.setTitle=function(){var e=this.node,t=this.calendar;return e.find(".start-box .cal-description").text(t.titleLeft),e.find(".end-box .cal-description").text(t.titleRight),this},d.prototype.setMonth=function(){var e=this.node,t=this.calendar,n=t.startTimeTurned,i=t.endTimeTurned,a=n.getFullYear()+"."+(n.getMonth()+1),r=i.getFullYear()+"."+(i.getMonth()+1);return e.find(".start-box .show-mnth").text(a),e.find(".end-box .show-mnth").text(r),this},d.prototype.selectDate=function(e,t){var n,i=this.calendar;0===t?(n=i.startTimeTurned,i.startTimeSelected=new Date(n.getFullYear(),n.getMonth(),e)):1===t&&(n=i.endTimeTurned,i.endTimeSelected=new Date(n.getFullYear(),n.getMonth(),e)),this.setItems(0).setItems(1)},d.prototype.confirmUserSelectedTime=function(){var e=this.calendar,t=e.startTimeSelected.getTime(),n=e.endTimeSelected.getTime();e.startTime=new Date(t),e.endTime=new Date(n),e.startTimeTurned=new Date(t),o.endTimeTurned=new Date(n),this.setItems(0).setItems(1),this.hide(),e.callback&&e.callback(new Date(t),new Date(n))},d.prototype.setItems=function(e){var n,i,a,d=this,o=this.node,s=this.calendar;0===e?(n=s.startTimeTurned,i=s.startTimeSelected,a=o.find(".start-box .cal-date")):1===e&&(n=s.endTimeTurned,i=s.endTimeSelected,a=o.find(".end-box .cal-date"));var l=new Date(n.getFullYear(),n.getMonth(),1).getDay(),c=(i.getDate(),r(n));a.empty();for(var m=0;m<l;m++){var u=t(document.createElement("span"));a.append(u)}for(var T=0;T<c;T++){var u=t(document.createElement("span"));u.text(T+1),a.append(u),i.getFullYear()===n.getFullYear()&&i.getMonth()===n.getMonth()&&i.getDate()===T+1?u.addClass("current"):u.addClass("enabled")}return a.find("span.enabled").click(function(n){var i=t(n.target);d.selectDate(Number(i.text()),e)}),this},d.prototype.setProgress=function(){var e=this.node,t=this.calendar,n=t.startTimeSelected,i=t.endTimeSelected,a=r(n),d=r(i),o=n.getDate()/a*100,s=i.getDate()/d*100;return e.find(".start-box .cal-progress .cal-sub-pro").css("width",o+"%"),e.find(".end-box .cal-progress .cal-sub-pro").css("width",s+"%"),this},d.prototype.show=function(){var n,i,a=this.node,r=this.calendar.outsetNode,d=a.find(".wCalendar-box"),o=r.fixedOffset().left,s=r.fixedOffset().top,l=r.width(),c=r.height();return a.find(".arrow").hide(),t(e).width()-o-l>o?(i=o,d.removeClass("arrow-right")):(i=o+l-499,d.addClass("arrow-right")),t(e).height()-s-c>s?(n=s+c+20,a.find(".arrow.top").show()):(n=s-346,a.find(".arrow.bottom").show()),d.css("top",n+"px").css("left",i+"px"),a.show(),this},d.prototype.hide=function(){var e=this.calendar,t=new Date(e.startTime.getTime()),n=new Date(e.endTime.getTime());return e.startTimeSelected=new Date(t.getTime()),e.startTimeTurned=new Date(t.getTime()),e.endTimeSelected=new Date(n.getTime()),e.endTimeTurned=new Date(n.getTime()),this.node.hide(),this.update(),this},d.prototype.update=function(){return this.setMonth().setItems(0).setItems(1).setProgress(),this};var o=function(e,n){var a,r,o,s,l,c=this;c.outsetNode=t(e),c.mode=i(n,"mode",0),c.single=i(n,"single",!1),c.titleLeft=i(n,"titleLeft","Start Date and Time"),c.titleRight=i(n,"titleRight","End Date and Time"),r=new Date,1===n.mode?(a=r.getDay()||7,r.setDate(r.getDate()-a+1)):2===n.mode&&r.setDate(1),o=r.getTime(),c.startTime=i(n,"startTime",new Date(o)),c.endTime=i(n,"endTime",new Date(o)),s=c.startTime.getTime(),l=c.endTime.getTime(),c.startTimeSelected=new Date(s),c.endTimeSelected=new Date(l),c.startTimeTurned=new Date(s),c.endTimeTurned=new Date(l),c.calendarNodeInstance=new d(c),n.callback&&(c.callback=n.callback),c.outsetNode.click(function(){c.calendarNodeInstance.show()})},s=o.prototype;s.show=function(){this.calendarNodeInstance.show()},s.hide=function(){this.calendarNodeInstance.hide()},s.setTime=function(e,t){var n,i;if(void 0===e)throw new Error("startTime required");if(!(e instanceof Date))throw new Error("Date instance required");if(n=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),void 0===t)t=new Date(n),i=n;else{if(!(t instanceof Date))throw new Error("Date instance required");i=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}if(i<n)throw new Error("endTime smaller than startTime");if(1===this.mode&&(1!==e.getDay()||1!==t.getDay()))throw new Error("Monday required in week mode");if(2===this.mode&&(1!==e.getDate()||1!==t.getDate()))throw new Error("1st day required in month mode");this.startTime=new Date(n),this.endTime=new Date(i),this.startTimeSelected=new Date(n),this.endTimeSelected=new Date(i),this.startTimeTurned=new Date(n),this.endTimeTurned=new Date(i),this.calendarNodeInstance.update()},s.getTime=function(){return{startTime:new Date(this.startTime.getTime()),endTime:new Date(this.endTime.getTime())}},e.wCalendar={init:function(e,n){if(void 0===e)return void a("1 argument required");if(!t(e).nodeList[0])return void a(e+" doesn't exist");if(void 0!==n){if("object"!=typeof n)return void a("the second argument should be an object");if(void 0!==n.mode&&0!==n.mode&&1!==n.mode&&2!==n.mode)return void a("the value of config.mode should be 0, 1 or 2");if(void 0!==n.single&&n.single!==!0&&n.single!==!1)return void a("the value of config.single should be true or false");if(void 0!==n.startTime&&n.startTime instanceof Date!=!0)return void a("startTime: a Date instance required");if(void 0!==n.endTime){if(n.endTime instanceof Date!=!0)return void a("endTime: a Date instance required");if(void 0===n.startTime)return void a("startTime required")}if(n.single===!1&&void 0!==n.endTime&&n.endTime.getTime()<n.startTime.getTime())return void a("endTime should be larger than startTime");if(void 0!==n.callback&&"function"!=typeof n.callback)return void a("callback: function required")}return new o(t(e).nodeList[0],n)},config:function(e){}}}(e,e.$wCalendar)}("undefined"!=typeof window?window:this);